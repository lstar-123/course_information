









<!DOCTYPE html>
<html lang="en">

<style>
	.secrecy{
		font-weight: 600;
		position: absolute;
		height: 100px;
		margin-top: 100px;
		margin-left: 29%;
		color: red;
		font-size: 15px;
	}
</style>
<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="/assets/css/login.css">
	<link rel="stylesheet" type="text/css" href="/css/style.css">
	<link rel="stylesheet" type="text/css" href="/assets/plugins/layui/layui.css"/>
	<title>登录</title>
	<meta http-equiv="keywords" content="教务管理 数字校园 综合教务管理 教学管理 中职数字校园 强智科技 高校教务 迎新 学工系统 收费系统 人事管理 科研管理 课程资源 网站群 在线支付管理 一卡通 智慧教室" />
	<meta http-equiv="description" content="湖南强智科技发展有限公司（www.qzdatasoft.com）是中国数字化校园软件专业提供商。十多年来，强智科技一直致力于中国教育信息化平台的研发与推广；强智新一代综合教学管理平台将教、学、管理、服务与决策完美结合的设计理念，众多高校的成功实施，必将成为行业的标杆，永载史册。" />

</head>
<body >


	
	
	<div class="edu-container-new">
		<div class="edu-content-new" >
			<div class="lf">
				<div class="edu-map-new" >
					<div class="layui-carousel" id="swiper">
						<div class="logo-area-new">
							<img src="/assets/images/logo.png" alt="">
							<p>教务一体化系统</p>
						</div>
						<div carousel-item>
							<img src="/assets/images/swiper.png" style="width:358px;height:320px"/>
							<img src="/assets/images/swiper1x.png" style="width:358px;height:320px"/>
							<img src="/assets/images/swiper2x.png" style="width:358px;height:320px"/>
						</div>
					</div>
				</div>
			</div>
			<form id="loginForm" name="loginForm" action="/Logon.do?method=logon" method="post">
				<div class="rt login-form-new">
					<h2>用户登录</h2>
						
					<p style="margin-bottom: 12px">&nbsp;&nbsp;</p>
						
					<div class="form-item-new">
						<span for="">账号</span>
						<input type="text" id="userAccount" name="userAccount" placeholder="请输入账号">
					</div>
					<div class="form-item-new">
						<span for="">密码</span>
						<input type="password" id="userPassword" name="userPassword" placeholder="请输入密码" autocomplete="off">
					</div>
					<div class="form-item">
						<font id="showMsg" color="red" size="2"></font>
					</div>
					
					<div class="form-item-new">
						<span for="">验证码</span>
						<input type="text" id="RANDOMCODE" name="RANDOMCODE" placeholder="请输入验证码">
						<img src="/verifycode.servlet" id="SafeCodeImg"  onclick="ReShowCode()" alt="" class="auth-code-img">
					</div>
					

						

					<div class="form-item-new">
							
							
						
						
					</div>


					<a class="btn-login-new" id="btn-login" onclick="login()" >登录</a>
					<div class="form-item">
					</div>
					<p class="login-cr">Copyright © 2020.湖南强智科技发展有限公司 </p>
					
					<input name="encoded" id="encoded" type="hidden" value=""/>
				</div>
			</form>
				
		</div>
		<div class="secrecy" style="">
			<p style="margin-top: 10px;">
				本平台为互联网非涉密平台，严禁处理、传输国家秘密、工作秘密及敏感信息。
			</p>
		</div>
	</div>
	


</body>
</html>


<script src="/framework/commonJs/jquery.min.js"></script>
<script src="/assets/plugins/layui/layui.all.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">

	function getBrowser(n) {
		var ua = navigator.userAgent.toLowerCase(),
				s,
				name = '',
				ver = 0;
		//探测浏览器
		(s = ua.match(/msie ([\d.]+)/)) ? _set("IE", _toFixedVersion(s[1])):
				(s = ua.match(/firefox\/([\d.]+)/)) ? _set("firefox", _toFixedVersion(s[1])) :
						(s = ua.match(/chrome\/([\d.]+)/)) ? _set("chrome", _toFixedVersion(s[1])) :
								(s = ua.match(/opera.([\d.]+)/)) ? _set("opera", _toFixedVersion(s[1])) :
										(s = ua.match(/version\/([\d.]+).*safari/)) ? _set("safari", _toFixedVersion(s[1])) : 0;

		function _toFixedVersion(ver, floatLength) {
			ver = ('' + ver).replace(/_/g, '.');
			floatLength = floatLength || 1;
			ver = String(ver).split('.');
			ver = ver[0] + '.' + (ver[1] || '0');
			ver = Number(ver).toFixed(floatLength);
			return ver;
		}
		function _set(bname, bver) {
			name = bname;
			ver = bver;
		}
		return (n == 'n' ? name : (n == 'v' ? ver : name + ver));
	}
	// debugger;
	var neihe = getBrowser("n"); // 所获得的就是浏览器所用内核。
	var banben = getBrowser("v");// 所获得的就是浏览器的版本号。
	var browser = getBrowser();// 所获得的就是浏览器内核加版本号。

	if(browser=='IE10.0' || browser=='IE9.0' || browser=='IE8.0' || browser=='IE7.0' || browser=='IE6.0' || browser=='IE5.0' || browser=='chrome69.0'){
		$("#showMsg").text("当前浏览器版本不适用，请使用推荐浏览器");
		document.getElementById("btn-login").innerHTML="查看推荐浏览器";
		document.getElementById("btn-login").onclick = myAlert;

	}
    //$("#zhmm").click(function(){
    //   JsMod('/findmm.htmlx',450,200);
    //})
    layui.use('carousel', function(){
        var carousel = layui.carousel;
        //建造实例
        carousel.render({
            elem: '#swiper',
            width: '100%' ,
            height:'100%',
            arrow: 'none' ,
            indicator:'inside'
        });
    });
    $('select').change(function(){
        $(this).css('color','#272727');
        $(this).css('font-weight','400');
    });
    //是否启用APP下载二维码
    
    function ReShowCode(){
        var SafeCodeImg = document.getElementById("SafeCodeImg");
        var url = "/verifycode.servlet?t="+Math.random();
        SafeCodeImg.src = url;
    }
	var dogNotPresent = false;
	var authCode = "";

    function login() {
		// debugger;
        var btn_login = $("#btn-login")[0].innerHTML;
        if(btn_login == "查看推荐浏览器") {
            $("#btn-login").click();
            return false;
        }
        if($("#userAccount").val() == "") {
            $("#showMsg").text("请输入账号");
            $("#userAccount").focus();
            return false;
        }
        if($("#userPassword").val() == "") {
            $("#showMsg").text("请输入密码");
            $("#userPassword").focus();
            return false;
        }
        
        if($("#RANDOMCODE").val() == "") {
            $("#showMsg").text("请输入验证码");
            $("#RANDOMCODE").focus();
            return false;
        }
        

		
		loginajax();

	}
	window.parent.addEventListener("message", function (event) {
		if (event.data.type == "SNTL_FROM_HOST") {
			var ReturnText = event.data.text;
			if ("GetUserNameEx" == ReturnText.InvokeMethod) {
				if (0 == ReturnText.Status) {
					lastStatus = 0;
					if (dogNotPresent) {
						dogNotPresent = false;
						clearInfo();
					}
					return;
				}
				else {
					reportStatus(parseInt(ReturnText.Status));
					lastStatus = ReturnText.Status;
					if (false == dogNotPresent) {
						dogNotPresent = true;
					}
					return;
				}
			}
			else if ("GetDigestEx" == ReturnText.InvokeMethod) {
				if (0 == ReturnText.Status) {
					var stat;
					var dogID;
					var digest;
					dogID = ReturnText.DogIdStr;
					digest = ReturnText.DigestStr;

					stat = doAuth(dogID, digest);

					if (stat != 0) {
						reportStatus(stat);
						return;
					}
					else {
						loginajax();
					}

					return;
				}
				else {
					reportStatus(parseInt(ReturnText.Status));
					return;
				}
			}
			else {
				return;
			}
		}
	}, false);

	function checkDog()
	{
		var stat = "";
		var scope = "<dogscope/>";

		//Get Auth Code
		if ("" == authCode) {
			authCode = getAuthCode();
		}

		//Get object
		objAuth = getAuthObject();

		if ( (navigator.userAgent.indexOf("Chrome") > 0) || (navigator.userAgent.indexOf("Firefox") > 0) ) {
			objAuth.GetUserNameEx(scope, authCode);
		}
		else {
			//Open Dog
			stat = objAuth.Open(scope, authCode);
			if(0 != stat)
			{
				dogNotPresent = true;
				reportStatus(stat);
			}
			else
			{
				if (dogNotPresent == true)
				{
					dogNotPresent = false;
					window.location.href = "index.htmlx";
				}
			}
		}
		//Execute the check again after 2 seconds
		setTimeout(checkDog, 2000);
	}
	function validatedogLogin(dogpwd)
	{
		try {
			checkDog();
			var challenge = "";
			var stat = "";
			var objAuth = "";
			var dogID = "";
			var digest = "";
			var scope = "<dogscope/>";
			var authCode = "";

			var pwd = dogpwd;
			if(pwd.length<6 || pwd.length>16)
			{
				reportStatus(905);
				return false;
			}
			if(window.ActiveXObject || "ActiveXObject" in window) //IE
			{
				//Add onfocus event
				var obj = document.getElementById("userPassword");
				if (Object.hasOwnProperty.call(window, "ActiveXObject") && !window.ActiveXObject)
				{// is IE11
					obj.addEventListener("onfocus", clearInfo, false);
				}
				else
				{
					obj.attachEvent("onfocus", clearInfo);
				}
			}
			//Get Object
			objAuth = getAuthObject();

			//Get Auth Code
			if ("" == authCode) {
				authCode = getAuthCode();
			}

			if ( (navigator.userAgent.indexOf("Chrome") > 0) || (navigator.userAgent.indexOf("Firefox") > 0) ) {  //Chrome or Firefox

				//Get challenge string
				challenge = getChallenge();
				if(challenge.toString().length < 32)
				{
					if(challenge == "001")
					{
						reportStatus(916);
					}
					else if(challenge == "002")
					{
						reportStatus(917);
					}
					else
					{
						reportStatus(918);
					}
					return false;
				}

				//Generate digest
				objAuth.GetDigestEx(scope, authCode, pwd, challenge);

				return false;

			}
			//Open the dog
			stat = objAuth.Open(scope, authCode);
			if(stat != 0)
			{
				reportStatus(stat);
				return false;
			}

			//Verify the password
			stat = objAuth.VerifyUserPin(pwd);
			if(stat != 0)
			{
				objAuth.Close();
				reportStatus(stat);
				return false;
			}

			//Get the DogID
			stat = objAuth.GetDogID();
			if(stat != 0)
			{
				objAuth.Close();
				reportStatus(stat);
				return false;
			}

			//Save the DogID
			dogID = objAuth.DogIdStr;

			challenge = getChallenge();
			if(challenge.toString().length < 32)
			{
				if(challenge == "001")
				{
					reportStatus(916);
				}
				else if(challenge == "002")
				{
					reportStatus(917);
				}
				else
				{
					reportStatus(918);
				}
				window.objAuth.Close();
				return false;
			}

			//Generate digest
			stat = objAuth.GetDigest(challenge);
			if(stat != 0)
			{
				objAuth.Close();
				reportStatus(stat);
				return false;
			}

			digest = objAuth.DigestStr;

			//Do authenticate
			stat = doAuth(dogID, digest);
			if(stat != 0)
			{
				objAuth.Close();
				reportStatus(stat);
				return false;
			}

			objAuth.Close();
			return true;
		}catch (e) {
			alert("请安装加密狗插件，插入加密狗！")
			return  false;
		}
	}
	function loginajax()
	{
		var strUrl = "/Logon.do?method=logon&flag=sess";
		$.ajax( {
			url:strUrl,
			type:"post",
			cache:false,
			dataType:"text",
			success:function(dataStr) {
				if(dataStr=="no"){
					return false;
				}else{
					var scode=dataStr.split("#")[0];
					var sxh=dataStr.split("#")[1];
					var code=document.getElementById("userAccount").value+"%%%"+document.getElementById("userPassword").value;
					var encoded="";
					for(var i=0;i<code.length;i++){
						if(i<20){
							encoded=encoded+code.substring(i,i+1)+scode.substring(0,parseInt(sxh.substring(i,i+1)));
							scode = scode.substring(parseInt(sxh.substring(i,i+1)),scode.length);
						}else{
							encoded=encoded+code.substring(i,code.length);
							i=code.length;
						}
					}
					document.getElementById("encoded").value=encoded;
					if("logon"!="logonLdap"){
						document.getElementById("userPassword").value="";
					}

					document.getElementById("loginForm").submit();
				}
			},
			error:function() {
				alert("计算异常！");
			}
		});
	}
    $(function(){
        $(document).on("keyup", function(e){
            if(e.keyCode == 13) {
                login();
            }
        });
    });

    /***
     *切换验证码
     **/
    function QRcodeFun(type) {
        if("1" == type ){
            $("#ul1").hide();
            $("#ul2").show();
            $("#QRcodeSkip").hide();
        }else{
            $("#ul2").hide();
            $("#ul1").show();
            $("#QRcodeSkip").show();
        }

    }

    function fsyzm() {
        if($("#userAccount").val() == "") {
            $("#showMsg").text("请输入账号");
            $("#userAccount").focus();
            return false;
        }
        if($("#userPassword").val() == "") {
            $("#showMsg").text("请输入密码");
            $("#userPassword").focus();
            return false;
        }
        var strUrl = "/Logon.do?method=logonByDxfz&userAccount="+$("#userAccount").val()+"&userPassword="+$("#userPassword").val();
        $.ajax( {
            url:strUrl,
            type:"post",
            cache:false,
            dataType:"text",
            success:function(dataStr) {
                if(dataStr=="no"){
                    return false;
                }else{
                    if(dataStr.length>4){
                        alert(dataStr);
                    }else{
                        document.getElementById("yzmyc").value=dataStr;
                    }
                }
            },
            error:function() {
                alert("计算异常！");
            }
        });
        var bt01 = document.getElementById("bt01");
        document.getElementById("sfgq").value="0";
        bt01.disabled = true;  //当点击后倒计时时候不能点击此按钮
        var time = 60;  //倒计时60秒
        var timer = setInterval(fun1, 1000);  //设置定时器
        function fun1() {
            time--;
            if(time>=0) {
                bt01.value = time + "s后重新发送";
            }else{
                bt01.value = "重新发送验证码";
                bt01.disabled = false;  //倒计时结束能够重新点击发送的按钮
                document.getElementById("yzmyc").value=""; // 清除验证码
                document.getElementById("sfgq").value="1"; //验证码是否过期
                clearTimeout(timer);  //清除定时器
                time = 60;  //设置循环重新开始条件
            }
        }
    }


	function myAlert(){
		window.open('/findllq.htmlx',450,200);
	}

	(function () {
		var xxdm = '12304';
		if(xxdm == '10534'){
			$("#indexbg").removeClass("edu-container-new").addClass("edu-container-new_hnkjdx");
		}
		if(xxdm == '12649'){
			$("#indexbg").removeClass("edu-container-new").addClass("edu-container-new_hnkjdxxxxy");
		}
	})();

	(function ($) {
		$.fn.extend({
			capsLockTip: function () {
				return this.each(function () {
					//创建对象实例并保存。
					//获取实例对象：var api = $("#txtPWD").data("txtPWD");
					var ins = new $.CapsLockTip($(this));
					$(this).data(this.id, ins);
				});
			}
		});


		//创建一个实例。
		//___target jq目标对象。
		//___divTipID   显示提示文本的div。
		$.CapsLockTip = function (___target) {
			//设置当前实例的配置参数。
			this.target = ___target;
			var _this = this;

			$(document).ready(function () {
				_this.target.bind("keypress", function (_event) {
					var e = _event || window.event;
					var kc = e.keyCode || e.which;
					var isShift = e.shiftKey || (kc == 16) || false;
					$.fn.capsLockTip.capsLockActived = false;
					if ((kc >= 65 && kc <= 90 && !isShift) || (kc >= 97 && kc <= 122 && isShift))
						$.fn.capsLockTip.capsLockActived = true;
					_this.showTips($.fn.capsLockTip.capsLockActived);
				});

				_this.target.bind("keydown", function (_event) {
					var e = _event || window.event;
					var kc = e.keyCode || e.which;
					if (kc == 20 && null != $.fn.capsLockTip.capsLockActived){
						$.fn.capsLockTip.capsLockActived = !$.fn.capsLockTip.capsLockActived;
						_this.showTips($.fn.capsLockTip.capsLockActived);
					}
				});

				_this.target.bind("focus", function (_event) {
					if (null != $.fn.capsLockTip.capsLockActived)
						_this.showTips($.fn.capsLockTip.capsLockActived);
				});

				_this.target.bind("blur", function (_event) {
					_this.showTips(false);
				});
			});

			//创建显示大写锁定的div。
			this.createTooltip = function(){
				if(null != $.fn.capsLockTip.divTip)
					return $.fn.capsLockTip.divTip;

				$("body").append("<div id='divTip__985124855558842555' style='width:100px; height:25px; padding-top:3px; display:none; position:absolute; z-index:9999999999999; text-align:center; background-color:#FDF6AA; color:Red; font-size:12px; border:solid 1px #DBC492; border-bottom-color:#B49366; border-right-color:#B49366;'>大写锁定已打开</div>");
				$.fn.capsLockTip.divTip = $("#divTip__985124855558842555");

				return $.fn.capsLockTip.divTip;
			};

			//显示或隐藏大写锁定提示。
			this.showTips = function (display) {
				var divTip = _this.createTooltip();
				if (display) {
					var offset = _this.target.offset();
					divTip.css("left", offset.left + "px");
					divTip.css("top", offset.top + _this.target[0].offsetHeight + 3 + "px");
					divTip.show();
				}
				else {
					divTip.hide();
				}
			};

			//jq控件公用静态对象。

			//提示框。
			$.fn.capsLockTip.divTip = null;
			//大写锁定键状态
			$.fn.capsLockTip.capsLockActived = null;
		};
	})(jQuery);
	$("#userPassword").capsLockTip();
</script>
